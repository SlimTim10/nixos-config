* nixos-config

** From new NixOS installation
#+begin_src sh
$ git clone git@github.com:SlimTim10/nixos-config.git /home/tim/.nix-config
$ git clone git@github.com:SlimTim10/emacs-home.git /home/tim/emacs-home
$ cd ~/.nix-config
$ cp hardware.nix.example hardware.nix
$ ./nixos-rebuild.sh
#+end_src

** Auto mount USB external drive
#+begin_src sh
$ sudo fdisk -l # find the drive
$ sudo mkdir -p /mnt/external-hdd
$ sudo mount -t ntfs -o umask=000 /dev/sdb1 /mnt/external-hdd # for NTFS-formatted drive, full R/W permission
$ sudo mkdir -p /mnt/external-ssd
$ sudo mount -t ntfs -o umask=000 /dev/sda2 /mnt/external-ssd
$ sudo nixos-generate-config # updates /etc/nixos/hardware-configuration.nix
#+end_src

** Storage management (garbage collection)
You can remove all but the current generation with

#+begin_src sh
$ sudo nix-collect-garbage -d
#+end_src

There are also user-specific generations for different things (eg. home-manager). These can be removed with

#+begin_src sh
$ nix-collect-garbage -d
#+end_src

More info
- https://nixos.wiki/wiki/Storage_optimization
- https://nixos.org/manual/nix/stable/#sec-garbage-collection
